<!DOCTYPE html>
<html>
<head><title>FIR</title></head>
<body>
<div>
<ol>
<li>Complainant Name:<input id="1"></li>

<li>Father/Husband Name:<input id="2"></li>

<li>occupation:<input id="3"></li>

<li>Age:<input id="4"></li>

<li>Gender:<input id="5"></li>

<li>Address:<input id="6"></li>

<li>Phone/Email:<input id="7"></li>

<li>Holiday(yes/no):<input id="8"></li>

<li>Holiday name:<input id="9"></li>

<li>Festival(yes/no):<input id="10"></li>

<li>Festival name:<input id="11"></li>

<li>weapon used:<input id="12"></li>

<li>Date :<input id="13"></li>

<li>Time:<input id="14"></li>

<li>Time(Morning/Afternoon...):<input id="15"></li>
  
<li>Place of Incident:<input id="16"></li>

<li>Location of Incident:<input id="17"></li>

<li>Type of Incident:<input id="18"></li></ol>

<button onclick="create()">SUBMIT</button></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

<script>
function create() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const pageWidth = doc.internal.pageSize.getWidth();

    const formData = {
        name: document.getElementById("1").value,
        father: document.getElementById("2").value,
        occupation: document.getElementById("3").value,
        age: document.getElementById("4").value,
        gender: document.getElementById("5").value,
        address: document.getElementById("6").value,
        contact: document.getElementById("7").value,
        holiday: document.getElementById("8").value,
        holidayName: document.getElementById("9").value,
        festival: document.getElementById("10").value,
        festivalName: document.getElementById("11").value,
        weapon: document.getElementById("12").value,
        date: document.getElementById("13").value,
        time: document.getElementById("14").value,
        timePeriod: document.getElementById("15").value,
        place: document.getElementById("16").value,
        location: document.getElementById("17").value,
        incidentType: document.getElementById("18").value
    };

    doc.setFontSize(18);
    doc.text("FIRST INFORMATION REPORT (F.I.R.)", pageWidth / 2, 15, { align: 'center' });
    
    const tableRows = Object.entries(formData).map(([label, value], index) => [`${index + 1}. ${label}`, value]);

    doc.autoTable({
        startY: 30,
        head: [['Field', 'Value']],
        body: tableRows,
        theme: 'striped'
    });

    doc.save(`FIR_${formData.name}_${formData.date}.pdf`);

    fetch("http://127.0.0.1:5000/save_fir", {
        method: "POST",
        mode: "cors", 
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(result => {
        alert("Success! Record added to CSV.");
        
    })
    .catch(err => {
        console.error("Fetch error:", err);
        alert("Could not connect to local server. PDF saved locally only.");
    });
}
  
</script>
</body>
</html>
